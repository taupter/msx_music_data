10 CLEAR 255,&HA600::DEFINTA-Z
20 KEYOFF:COLOR15,4,4
30 Z$=CHR$(254):ZA=8*254:T=1
40 'AD=&H800:SCREEN0:WIDTH40
50 'AD=&H1000:SCREEN0:WIDTH80
60 AD=&H0:SCREEN1:WIDTH32
70 BLOAD"BGM.BIN"
80 READA$:IF A$="" THEN 130
90 A=ASC(A$):READA$
100 FOR I=0TO7:VPOKE AD+(A+C)*8+I,VAL("&h"+MID$(A$,I*2+1,2)):NEXT
110 GOTO 80
120 '
130 FORI=0TO7:VPOKE ZA+I,0:NEXT:ZI=8:ON INTERVAL=T GOSUB270:INTERVAL ON
140 READ Y:IF Y<0 THEN 230
150 READ A$:X=(32-LEN(A$))/2:Y=Y*2:Z=X:L=LEN(A$)
160 FOR I=1 TO L:C$=MID$(A$,I,1):C=ASC(C$):CA=C*8
170 LOCATE X,Y:PRINT STRING$(32-X,Z$);:ZI=0
180 IF ZI<8 THEN 180
190 LOCATE X,Y:PRINT C$;:X=X+1:NEXT:CA=32*8:ZI=0
200 IF ZI<8 THEN 200
210 LOCATE X,Y:PRINTSPACE$(32-X);
220 GOTO 130
230 GOSUB 620
240 I$=INPUT$(1):GOSUB 740
250 END
260 '
270 IF ZI>7 THEN RETURN
280 FORZJ=0TO6:VPOKEZA+ZJ,VPEEK(ZA+ZJ+1):NEXT
290 VPOKE ZA+7,VPEEK(CA+ZI):ZI=ZI+1:RETURN
300 DATA"A","000E1A1A323E62F2","B","007C32323C32327C"
310 DATA"C","003C62606062623C","D","007C32323232327C"
320 DATA"E","007F31343C34317F","F","007F31343C343078"
330 DATA"G","003C62606F62623C","H","00F762627E6262F7"
340 DATA"I","003C18181818183C","J","001E0C0C0C4C4C38"
350 DATA"K","00F3666C786C66F3","L","007830303031317F"
360 DATA"M","00E3766A626262F7","N","00E7727A6E6662F2"
370 DATA"O","003C62626262623C","P","007E31313E303078"
380 DATA"Q","003E61616165663B","R","00FC62627C6462F7"
390 DATA"S","003E61603E03433E","T","007F5D1C1C1C1C3E"
400 DATA"U","00F762626262623C","V","00F3613232361C1C"
410 DATA"W","00DB4949495D7722","X","00F76234182C46EF"
420 DATA"Y","00F762341818183C","Z","007F43161C34617F"
430 DATA":","0018180000181800",".","0000000018181800"
440 DATA"(","0001020404040201","c","0000182420241800"
450 DATA")","0080402020204080","1","000C04040404040E"
460 DATA"9","003C42423E02423C","8","003C42423C42423C"
470 '
480 DATA ""
490 DATA 1," "
500 DATA 2,"FINAL FANTASY II"
510 DATA 3," "
520 DATA 4," "
530 DATA 5," "
540 DATA 6," "
550 DATA 7,"(c) 1988 SQUARE"
560 DATA 8," "
570 DATA 9,"PROGRAMED BY NASIR"
580 DATA 10,"CHARACTER BY YOSHIKTAKA AMANO"
590 DATA 11,"SCENARIO BY KENJI TERADA"
600 DATA -1
610 '
620 ONSTOPGOSUB 660:GOSUB 690:STOPON
630 A$="FF2PRE":GOSUB 790:GOSUB 710
640 RETURN
650 '
660 GOSUB 740:END
670 '
680 'BGM Initialize
690 DEFUSR=&HCE00:I=USR(0):RETURN
700 'Start BGM
710 I(0)=0:I(1)=ST:DEFUSR=&HCE03:I=USR(VARPTR(I(0))):RETURN
720 DEFUSR=&HCE03:I=USR(VARPTR(I(0))):RETURN
730 'Stop BGM
740 DEFUSR=&HCE06:I=USR(0):RETURN
750 'Master volume
760 I(0)=V:DEFUSR=&HCE09:I=USR(VARPTR(I(0))):RETURN
770 'Load BGM data  &  read start address
780 INPUT"File name";A$
790 GOSUB 740:A$=A$+".bgm":BLOAD A$
800 OPEN A$ FOR INPUT AS #1:A$=INPUT$(3,#1):CLOSE #1
810 ST=ASC(MID$(A$,2,1)) + ASC(MID$(A$,3,1))*256 - 65536!
820 RETURN
